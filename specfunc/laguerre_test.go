package specfunc

import (
	"fmt"
	"github.com/lucky-se7en/ggsl/err"
	"strconv"
	"testing"
)

func TestLaguerreN(t *testing.T) {
	r := new(Result)
	cases := []struct {
		n                   int
		a, x, expected, tol float64
	}{
		{1, 0.5, 1.0, 0.5, TEST_TOL0},
		{2, 1.0, 1.0, 0.5, TEST_TOL1},
		{3, 2.0, 1.0, 2.3333333333333333333, TEST_TOL1},
		{4, 2.0, 0.5, 6.752604166666666667, TEST_TOL1},
		{90, 2.0, 0.5, -48.79047157201507897, TEST_TOL1},
		{90, 2.0, -100.0, 2.5295879275042410902e+63, TEST_TOL2},
		{90, 2.0, 100.0, -2.0929042259546928670e+20, TEST_TOL1},
		{100, 2.0, -0.5, 2.2521795545919391405e+07, TEST_TOL2},
		{100, 2.0, 0.5, -28.764832945909097418, TEST_TOL2},
		{1000, 2.0, -0.5, 2.4399915170947549589e+21, TEST_TOL3},
		{1000, 2.0, 0.5, -306.77440254315317525, TEST_TOL2}, /**/
		{100000, 2.0, 1.0, 5107.73491348319, TEST_TOL4},
		{1e5, 2.5, 2.5, -0.41491680394598644969113795e5, TEST_TOL4},
		{1e5 + 1, 2.5, 2.5, -0.41629446949552321027514888e5, TEST_TOL4},
		{1e6 + 1, 2.5, 2.5, -0.48017961545391273151977118e6, TEST_TOL4},
		{5e6 + 1, 2.5, 2.5, -0.15174037401611122446089494e7, TEST_TOL6},
		{8e6 + 1, 2.5, 2.5, 0.63251509472091810994286362e6, TEST_SNGL},
		{1e7 + 1, 2.5, 2.5, 0.15299484685632983178033887e7, TEST_SNGL},
		{1e8 + 1, 2.5, 2.5, 0.23645341644922756725290777e8, TEST_SNGL},
		{1e9 + 1, 2.5, 2.5, -0.17731002248958790286185878e8, 100 * TEST_SNGL},
		{1, -2.0, 1.0, -2.0, TEST_TOL0},
		{2, -2.0, 1.0, 0.5, TEST_TOL0},
		{3, -2.0, 1.0, 1.0 / 3.0, TEST_TOL0},
		{10, -2.0, 1.0, -0.04654954805996472663, TEST_TOL2},
		{10, -5.0, 1.0, -0.0031385030864197530864, TEST_TOL2},
		{10, -9.0, 1.0, -2.480158730158730159e-06, TEST_TOL5},
		{10, -11.0, 1.0, 2.7182818011463844797, TEST_TOL2},
		{10, -11.0, -1.0, 0.3678794642857142857, TEST_TOL2},
		{100, -2.0, 1.0, -0.0027339992019526273866, TEST_SQRT_TOL0},
		{100, -2.0, -1.0, 229923.09193402028290, TEST_TOL5},
		{100, -10.0, 1.0, 3.25966665871244092e-11, TEST_TOL6},
		{100, -10.0, -1.0, 0.00016484365618205810025, TEST_TOL6},
		{100, -20.0, 1.0, 5.09567630343671251e-21, TEST_TOL3},
		{100, -30.0, 1.0, 3.46063150272466192e-34, TEST_TOL1},
		{100, -50.0, 1.0, 1.20981872933162889e-65, TEST_TOL1},
		{100, -50.0, -1.0, 8.60763477742332922e-65, TEST_TOL1},
		{100, -50.5, 1.0, 4.84021010426688393e-31, TEST_TOL1},
		{100, -50.5, -1.0, 8.49861345212160618e-33, TEST_TOL1},
		{100, -101.0, 1.0, 2.7182818284590452354, TEST_TOL1},
		{100, -101.0, -1.0, 0.3678794411714423216, TEST_TOL1},
		{100, -102.0, 1.0, 271.8281828459045235, TEST_TOL1},
		{100, -102.0, -1.0, 37.52370299948711680, TEST_TOL1},
		{100, -110.0, 1.0, 1.0666955248998831554e+13, TEST_TOL1},
		{100, -110.0, -1.0, 1.7028306108058225871e+12, TEST_TOL1},
		{100, -200.0, 1.0, 7.47851889721356628e+58, TEST_TOL1},
		{100, -200.0, -1.0, 2.73740299754732273e+58, TEST_TOL1},
		{100, -50.0, 10.0, 4.504712811317745591e-21, TEST_SQRT_TOL0},
		{100, -50.0, -10.0, 1.475165520610679937e-11, TEST_TOL1},
		{100, 0.0, 0.5, 0.18682260367692278801, TEST_TOL2},
		{100, 0.0, 10.5, 9.1796907354050059874, TEST_TOL2},
		{100, 0.0, -10.5, 5.6329215744170606488e24, TEST_TOL2},
		{100, 0.0, 100.5, -3.9844782875811907525e20, TEST_TOL2},
		{100, 0.0, 150, -1.4463204337261709595e31, TEST_TOL2},
	}
	for i, c := range cases {
		t.Run(strconv.Itoa(i), func(t *testing.T) {
			stat := Laguerre_n_e(c.n, c.a, c.x, r)
			run_test_sf(t, stat, r, c.expected, c.tol, err.SUCCESS, fmt.Sprintf("Laguerre_n_e(%v,%v,%v)", c.n, c.a, c.x))

		})
	}
}
